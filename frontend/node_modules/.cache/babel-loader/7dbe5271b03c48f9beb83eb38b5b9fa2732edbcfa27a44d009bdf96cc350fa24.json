{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { loginRequest, logoutRequest } from \"./AuthRequests\";\nfunction getInitialAuthUserState() {\n  const authUserState = {\n    user: null,\n    isLoading: false,\n    error: \"\"\n  };\n  if (localStorage.getItem(\"user\")) {\n    authUserState.user = JSON.parse(localStorage.getItem(\"user\") || \"\");\n  }\n  return authUserState;\n}\nconst register = createAsyncThunk(\"user/register\", async registerDetails => {\n  return await registerRequest(registerDetails);\n});\nconst login = createAsyncThunk(\"user/login\", async loginDetails => {\n  return await loginRequest(loginDetails);\n});\nconst logout = createAsyncThunk(\"user/logout\", async (_, {\n  getState\n}) => {\n  const user = getState().auth.user;\n  if (!user) {\n    return Promise.reject(new Error(\"User not logged in\"));\n  }\n  return await logoutRequest(user);\n});\nconst authSlice = createSlice({\n  name: \"authentication\",\n  initialState: getInitialAuthUserState(),\n  reducers: {},\n  extraReducers: builder => {\n    builder.addCase(login.pending, state => {\n      state.user = null;\n      state.isLoading = true;\n      state.error = \"\";\n    }).addCase(login.fulfilled, (state, action) => {\n      state.user = action.payload;\n      state.isLoading = false;\n      state.error = \"\";\n    }).addCase(login.rejected, state => {\n      state.user = null;\n      state.isLoading = false;\n      state.error = \"Username or password may be incorrect\";\n    });\n    builder.addCase(logout.pending, state => {\n      state.isLoading = true;\n      state.error = \"\";\n    }).addCase(logout.fulfilled, state => {\n      state.user = null;\n      state.isLoading = false;\n      state.error = \"\";\n    }).addCase(logout.rejected, state => {\n      state.user = null;\n      state.isLoading = false;\n      state.error = \"Unable to logout\";\n    });\n  }\n});\nconst authReducer = authSlice.reducer;\nexport { login, logout };\nexport default authReducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","loginRequest","logoutRequest","getInitialAuthUserState","authUserState","user","isLoading","error","localStorage","getItem","JSON","parse","register","registerDetails","registerRequest","login","loginDetails","logout","_","getState","auth","Promise","reject","Error","authSlice","name","initialState","reducers","extraReducers","builder","addCase","pending","state","fulfilled","action","payload","rejected","authReducer","reducer"],"sources":["/Users/aryanchadha/Desktop/sp25-cs411-team059-MongoKings/frontend/src/services/Auth/AuthSlice.ts"],"sourcesContent":["import {\n  ActionReducerMapBuilder,\n  createAsyncThunk,\n  createSlice,\n} from \"@reduxjs/toolkit\";\nimport User from \"../../types/Authentication/User\";\nimport LoginInput from \"../../types/Authentication/LoginInput\";\nimport { loginRequest, logoutRequest } from \"./AuthRequests\";\nimport { RootState } from \"../../app/store\";\nimport RegisterInput from \"../../types/Authentication/RegisterInput\";\n\ninterface AuthUserState {\n  user: User | null;\n  isLoading: boolean;\n  error: string;\n}\n\nfunction getInitialAuthUserState(): AuthUserState {\n  const authUserState: AuthUserState = {\n    user: null,\n    isLoading: false,\n    error: \"\",\n  };\n  if (localStorage.getItem(\"user\")) {\n    authUserState.user = JSON.parse(localStorage.getItem(\"user\") || \"\");\n  }\n  return authUserState;\n}\n\nconst register = createAsyncThunk<string, RegisterInput>(\n  \"user/register\",\n  async (registerDetails: RegisterInput) => {\n    return await registerRequest(registerDetails);\n  }\n);\n\n\nconst login = createAsyncThunk<User, LoginInput>(\n  \"user/login\",\n  async (loginDetails: LoginInput) => {\n    return await loginRequest(loginDetails);\n  }\n);\n\nconst logout = createAsyncThunk<string, undefined, { state: RootState }>(\n  \"user/logout\",\n  async (_, { getState }) => {\n    const user = getState().auth.user;\n    if (!user) {\n      return Promise.reject(new Error(\"User not logged in\"));\n    }\n    return await logoutRequest(user);\n  }\n);\n\nconst authSlice = createSlice({\n  name: \"authentication\",\n  initialState: getInitialAuthUserState(),\n  reducers: {},\n  extraReducers: (builder: ActionReducerMapBuilder<AuthUserState>) => {\n    builder\n      .addCase(login.pending, (state) => {\n        state.user = null;\n        state.isLoading = true;\n        state.error = \"\";\n      })\n      .addCase(login.fulfilled, (state, action) => {\n        state.user = action.payload;\n        state.isLoading = false;\n        state.error = \"\";\n      })\n      .addCase(login.rejected, (state) => {\n        state.user = null;\n        state.isLoading = false;\n        state.error = \"Username or password may be incorrect\";\n      });\n      builder\n      .addCase(logout.pending, (state) => {\n        state.isLoading = true;\n        state.error = \"\";\n      })\n      .addCase(logout.fulfilled, (state) => {\n        state.user = null;\n        state.isLoading = false;\n        state.error = \"\";\n      })\n      .addCase(logout.rejected, (state) => {\n        state.user = null;\n        state.isLoading = false;\n        state.error = \"Unable to logout\";\n      });\n\n  },\n});\n\nconst authReducer = authSlice.reducer;\n\nexport {  login, logout };\nexport default authReducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}